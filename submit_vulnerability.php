<?php

if ($_SERVER["REQUEST_METHOD"] === "POST") {
    // Extract data from the form
    $name = $_POST["name"];
    $email = $_POST["email"];
    $severity = $_POST["severity"];
    $description = $_POST["description"];
    $steps = $_POST["steps"];

    // Validate and process the data (you should customize this part based on your needs)
    if (empty($name) || empty($email) || empty($severity) || empty($description) || empty($steps)) {
        // Handle validation errors, e.g., redirect back to the form with an error message
        header("Location: submission-form.php?error=empty_fields");
        exit();
    }

    // Save the vulnerability data to a database or file (customize this part based on your needs)
    // For example, you might want to log the data in a database for further review
    $submissionData = [
        'name' => $name,
        'email' => $email,
        'severity' => $severity,
        'description' => $description,
        'steps' => $steps,
    ];

    // Save the data to a file (for illustration purposes, customize based on your needs)
    $file = 'vulnerability_submissions.txt';
    $data = json_encode($submissionData) . PHP_EOL;
    file_put_contents($file, $data, FILE_APPEND);

    // Redirect back to a thank-you page or the homepage
    header("Location: thank-you.php");
    exit();
} else {
    // If someone tries to access this script directly, redirect them to the homepage
    header("Location: index.php");
    exit();
}
